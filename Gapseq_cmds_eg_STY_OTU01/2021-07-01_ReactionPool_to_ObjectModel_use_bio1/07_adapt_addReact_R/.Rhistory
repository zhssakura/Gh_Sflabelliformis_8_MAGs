met = as.list(React_id[i,]$met_id),
print(met)
}
for (i in nrow(React_id)) {
# Rid = React_id[i,]$Rid,
met = as.list(React_id[i,]$met_id),
print(met)
}
# Rid = React_id[i,]$Rid,
met = as.list(React_id[i,]$met_id)
View(met)
met[[1]]
model_OTU08_draft
for (i in nrow(React_id)) {
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = React_id[i,]$Rid,
met        = as.list(React_id[i,]$met_id),
Scoef      = as.list(React_id[i,]$met_Scoef)
reactName  = React_id[i,]$react_name,
reversible = React_id[i,]$react_rev,
metName    = as.list(React_id[i,]$met_name),
metComp    = as.list(React_id[i,]$met_comp),
)
}
React_id[i,]$Rid
for (i in nrow(React_id)) {
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = React_id[i,]$Rid,
met        = as.list(React_id[i,]$met_id),
Scoef      = as.list(React_id[i,]$met_Scoef)
reactName  = React_id[i,]$react_name,
reversible = React_id[i,]$react_rev,
metName    = as.list(React_id[i,]$met_name),
metComp    = as.list(React_id[i,]$met_comp)
)
}
for (i in nrow(React_id)) {
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = React_id[i,]$Rid,
met        = as.list(React_id[i,]$met_id),
Scoef      = as.list(React_id[i,]$met_Scoef)
reactName  = React_id[i,]$react_name,
reversible = React_id[i,]$react_rev,
metName    = as.list(React_id[i,]$met_name),
metComp    = as.list(React_id[i,]$met_comp)
)
}
for (i in nrow(React_id)) {
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = React_id[i,]$Rid,
met        = React_id[i,]$met_id
# Scoef      = as.list(React_id[i,]$met_Scoef)
# reactName  = React_id[i,]$react_name,
# reversible = React_id[i,]$react_rev,
# metName    = as.list(React_id[i,]$met_name),
# metComp    = as.list(React_id[i,]$met_comp)
)
}
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = React_id[i,]$Rid,
met        = React_id[i,]$met_id,
Scoef      = React_id[i,]$met_Scoef
# reactName  = React_id[i,]$react_name,
# reversible = React_id[i,]$react_rev,
# metName    = as.list(React_id[i,]$met_name),
# metComp    = as.list(React_id[i,]$met_comp)
)
React_id[i,]$met_Scoef
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = React_id[1,]$Rid,
met        = React_id[1,]$met_id,
Scoef      = React_id[1,]$met_Scoef
# reactName  = React_id[i,]$react_name,
# reversible = React_id[i,]$react_rev,
# metName    = as.list(React_id[i,]$met_name),
# metComp    = as.list(React_id[i,]$met_comp)
)
React_id[1,]$Rid,
React_id[1,]$Rid
React_id[1,]$met_id
React_id[1,]$met_Scoef
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = React_id[1,]$Rid,
met        = React_id[1,]$met_id,
Scoef      = React_id[1,]$met_Scoef,
reactName  = React_id[1,]$react_name,
reversible = React_id[1,]$react_rev,
metName    = React_id[1,]$met_name,
metComp    = React_id[1,]$met_comp
)
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = React_id[1,]$Rid,
met        = React_id[1,]$met_id,
Scoef      = as.integer(React_id[1,]$met_Scoef),
reactName  = React_id[1,]$react_name,
reversible = React_id[1,]$react_rev,
metName    = React_id[1,]$met_name,
metComp    = React_id[1,]$met_comp
)
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = React_id[1,]$Rid,
met        = React_id[1,]$met_id,
Scoef      = as.integer(React_id[1,]$met_Scoef),
reactName  = React_id[1,]$react_name,
reversible = React_id[1,]$react_rev,
metName    = React_id[1,]$met_name,
metComp    = React_id[1,]$met_comp
)
model_OTU08_draft_new
model_OTU08_draft
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = React_id[i,]$Rid,
met        = React_id[i,]$met_id,
Scoef      = as.integer(React_id[i,]$met_Scoef),
reactName  = React_id[i,]$react_name,
reversible = React_id[i,]$react_rev,
metName    = React_id[i,]$met_name,
metComp    = as.integer(React_id[i,]$met_comp)
)
model_OTU08_draft
model_OTU08_draft_new
for (i in nrow(React_id)) {
model_OTU08_draft <- addReact(
model_OTU08_draft,
id         = React_id[i,]$Rid,
met        = React_id[i,]$met_id,
Scoef      = as.integer(React_id[i,]$met_Scoef),
reactName  = React_id[i,]$react_name,
reversible = React_id[i,]$react_rev,
metName    = React_id[i,]$met_name,
metComp    = as.integer(React_id[i,]$met_comp)
)
}
model_OTU08_draft
for (i in nrow(React_id)) {
model_OTU08_draft <- addReact(
model_OTU08_draft,
id         = React_id[i,]$Rid,
met        = React_id[i,]$met_id,
Scoef      = as.integer(React_id[i,]$met_Scoef),
reactName  = React_id[i,]$react_name,
reversible = React_id[i,]$react_rev,
metName    = React_id[i,]$met_name,
metComp    = React_id[i,]$met_comp
)
}
React_id[1,]$met_id
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = React_id[1,]$Rid,
met        = React_id[1,]$met_id,
Scoef      = as.integer(React_id[1,]$met_Scoef),
reactName  = React_id[1,]$react_name,
reversible = React_id[1,]$react_rev,
metName    = React_id[1,]$met_name,
metComp    = React_id[1,]$met_comp
)
model_OTU08_draft
OTU08_draft = paste(mydir,'03_Get_ObjectModel/STY_Merged_OTU08-draft_v20200607.RDS',sep = '')
model_OTU08_draft = readRDS(OTU08_draft)
model_OTU08_draft
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = React_id[1,]$Rid,
met        = React_id[1,]$met_id,
Scoef      = as.integer(React_id[1,]$met_Scoef),
reactName  = React_id[1,]$react_name,
reversible = React_id[1,]$react_rev,
metName    = React_id[1,]$met_name,
metComp    = React_id[1,]$met_comp
)
model_OTU08_draft_new
View(model_OTU08_draft)
View(model_OTU08_draft_new)
model_OTU08_draft_new@react_id
model_OTU08_draft_new@react_id[1460,]
model_OTU08_draft_new@react_id[1460]
model_OTU08_draft_new@react_id[1459]
model_OTU08_draft_new@react_id[1]
getwd = getwd()
getwd
mydir = '/Users/zzfanyi/Bioinfo/EMP500/02-shotgun/GapSeq_models/STY_models/GapSeq_v20200607_mergebin_gapseq_v0607_MKSdb_Diet_Jo_lALL_b_uncon/2021-01-12_ReactionPool_to_ObjectModel/'
OTU08_draft = paste(mydir,'03_Get_ObjectModel/STY_Merged_OTU08-draft_v20200607.RDS',sep = '')
model_OTU08_draft = readRDS(OTU08_draft)
model_OTU08_draft
React_id = read.delim(paste(mydir,'02_Get_RP_equations/Reaction_id_in_ReactionPool_Addreact.txt',sep = ''))
React_id[1,]
React_id[1,]$Rid
React_id[1,]$met_id
as.integer(React_id[1,]$met_Scoef)
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = React_id[1,]$Rid,
met        = React_id[1,]$met_id,
Scoef      = React_id[1,]$met_Scoef,
reactName  = React_id[1,]$react_name,
reversible = React_id[1,]$react_rev,
metName    = React_id[1,]$met_name,
metComp    = React_id[1,]$met_comp
)
React_id[1,]$met_Scoef
class(React_id[1,]$met_Scoef)
as.numeric(React_id[1,]$met_Scoef)
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = React_id[1,]$Rid,
met        = React_id[1,]$met_id,
Scoef      = as.numeric(as.character(React_id[1,]$met_Scoef)),
reactName  = React_id[1,]$react_name,
reversible = React_id[1,]$react_rev,
metName    = React_id[1,]$met_name,
metComp    = React_id[1,]$met_comp
)
as.numeric(as.character(React_id[1,]$met_Scoef))
as.numeric(as.list(React_id[1,]$met_Scoef))
React_id[1,]$met_Scoef)
React_id[1,]$met_Scoef
type(React_id[1,]$met_Scoef)
as.numeric(unlist(React_id[1,]$met_Scoef))
as.integer(unlist(React_id[1,]$met_Scoef))
unlist(React_id[1,]$met_Scoef)
React_id[1,]$met_Scoef)
React_id[1,]$met_Scoef
levels(React_id)
levels(React_id[1,]$Rid)
React_id[1,]$Rid
as.character(React_id[1,]$Rid)
as.character(React_id[1,]$met_id)
as.list(as.character(React_id[1,]$met_id))
unlist(as.character(React_id[1,]$met_id))
str_split(as.character(React_id[1,]$met_id))
id         = as.character(React_id[1,]$Rid),
met        = str_split(as.character(React_id[1,]$met_id),','),
Scoef      = as.integer(unlist(React_id[1,]$met_Scoef)),
reactName  = React_id[1,]$react_name,
reversible = React_id[1,]$react_rev,
metName    = React_id[1,]$met_name,
metComp    = React_id[1,]$met_comp
id         = as.character(React_id[1,]$Rid)
as.character(React_id[1,]$Rid)
str_split(as.character(React_id[1,]$met_id),',')
class(str_split(as.character(React_id[1,]$met_id),','))
React_id[1,]$met_Scoef
str_split(as.character(React_id[1,]$met_Scoef)
)
str_split(as.character(React_id[1,]$met_Scoef))
as.character(React_id[1,]$met_Scoef)
str_split(as.character(React_id[1,]$met_Scoef),',')
as.integer(str_split(as.character(React_id[1,]$met_Scoef),','))
React_id[1,]$react_name
React_id[1,]$react_rev
as.character(React_id[1,]$react_rev)
as.character(React_id[1,]$Rid)
as.character(React_id[1,]$react_rev)
React_id[1,]$met_name
str_split(as.character(React_id[1,]$met_name,',')
)
str_split(as.character(React_id[1,]$met_name),',')
metName = c('NH3','H+[e]','NH4')
metName
React_id[1,]$met_comp
str_split(as.character(React_id[1,]$met_comp,',')
)
str_split(as.character(React_id[1,]$met_comp),',')
as.character(React_id[1,]$Rid)
str_split(as.character(React_id[1,]$met_id),',')
as.character(str_split(as.character(React_id[1,]$met_id),','))
class(str_split(as.character(React_id[1,]$met_id),',')
)
as.character(React_id[1,]$Rid)
str_split(as.character(React_id[1,]$met_id),',')
as.integer(str_split(as.character(React_id[1,]$met_Scoef),','))
as.numeric(str_split(as.character(React_id[1,]$met_Scoef),','))
str_split(as.character(React_id[1,]$met_Scoef),',')
as.character(React_id[1,]$Rid)
React_id[1,]$react_rev
str_split(as.character(React_id[1,]$met_name),',')
str_split(as.character(React_id[1,]$met_comp),',')
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = as.character(React_id[1,]$Rid),
met        = str_split(as.character(React_id[1,]$met_id),','),
Scoef      = str_split(as.character(React_id[1,]$met_Scoef),','),
reactName  = as.character(React_id[1,]$Rid),
reversible = React_id[1,]$react_rev,
metName    = str_split(as.character(React_id[1,]$met_name),','),
metComp    = str_split(as.character(React_id[1,]$met_comp),',')
)
for (i in nrow(React_id)) {
model_OTU08_draft <- addReact(
model_OTU08_draft,
id         = React_id[i,]$Rid,
met        = React_id[i,]$met_id,
Scoef      = as.integer(React_id[i,]$met_Scoef),
reactName  = React_id[i,]$react_name,
reversible = React_id[i,]$react_rev,
metName    = React_id[i,]$met_name,
metComp    = React_id[i,]$met_comp
)
}
model_OTU08_draft
model_OTU08_draft_new
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = as.character(React_id[1,]$Rid),
met        = str_split(as.character(React_id[1,]$met_id),','),
Scoef      = str_split(as.character(React_id[1,]$met_Scoef),','),
reactName  = as.character(React_id[1,]$Rid),
reversible = React_id[1,]$react_rev,
metName    = str_split(as.character(React_id[1,]$met_name),','),
metComp    = str_split(as.character(React_id[1,]$met_comp),',')
)
str_split(as.character(React_id[1,]$met_id),',')
str_split(as.character(React_id[1,]$met_id),',')[1]
str_split(as.character(React_id[1,]$met_id),',')[[1]]
as.character(React_id[1,]$Rid)
str_split(as.character(React_id[1,]$met_id),',')[[1]]
str_split(as.character(React_id[1,]$met_Scoef),',')[[1]]
as.character(React_id[1,]$Rid)
React_id[1,]$react_rev
str_split(as.character(React_id[1,]$met_name),',')[[1]]
str_split(as.character(React_id[1,]$met_comp),',')[[1]]
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = as.character(React_id[1,]$Rid),
met        = str_split(as.character(React_id[1,]$met_id),',')[[1]],
Scoef      = str_split(as.character(React_id[1,]$met_Scoef),',')[[1]],
reactName  = as.character(React_id[1,]$Rid),
reversible = React_id[1,]$react_rev,
metName    = str_split(as.character(React_id[1,]$met_name),',')[[1]],
metComp    = str_split(as.character(React_id[1,]$met_comp),',')[[1]]
)
addReact
class(str_split(as.character(React_id[1,]$met_id),',')[[1]])
class(str_split(as.character(React_id[1,]$met_Scoef),',')[[1]])
as.integer(str_split(as.character(React_id[1,]$met_Scoef),',')[[1]])
as.character(React_id[1,]$Rid)
str_split(as.character(React_id[1,]$met_id),',')[[1]]
as.integer(str_split(as.character(React_id[1,]$met_Scoef),',')[[1]])
as.character(React_id[1,]$Rid)
React_id[1,]$react_rev
str_split(as.character(React_id[1,]$met_name),',')[[1]]
as.integer(str_split(as.character(React_id[1,]$met_comp),',')[[1]])
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = as.character(React_id[1,]$Rid),
met        = str_split(as.character(React_id[1,]$met_id),',')[[1]],
Scoef      = as.integer(str_split(as.character(React_id[1,]$met_Scoef),',')[[1]]),
reactName  = as.character(React_id[1,]$Rid),
reversible = React_id[1,]$react_rev,
metName    = str_split(as.character(React_id[1,]$met_name),',')[[1]],
metComp    = s.integer(str_split(as.character(React_id[1,]$met_comp),',')[[1]])
)
View(model_OTU08_draft_new)
model_OTU08_draft_new@react_id[1461]
# Check the reaction number after new reaction added.
class(model_OTU08_draft_add_R00332)
View(model_OTU08_draft_new)
model_OTU08_draft_new@react_num
# check the latest reaction added:
model_OTU08_draft_new@react_id[model_OTU08_draft_new@react_num]
as.character(React_id[1,]$Rid)
str_split(as.character(React_id[1,]$met_id),',')[[1]]
as.integer(str_split(as.character(React_id[1,]$met_Scoef),',')[[1]])
as.character(React_id[1,]$Rid)
React_id[1,]$react_rev
str_split(as.character(React_id[1,]$met_name),',')[[1]]
as.integer(str_split(as.character(React_id[1,]$met_comp),',')[[1]])
model_OTU08_draft@react_id[model_OTU08_draft@react_num]
model_OTU08_draft@react_id[model_OTU08_draft@react_num]
model_OTU08_draft@react_num
react_id[model_OTU08_draft@react_num]
model_OTU08_draft@react_id
model_OTU08_draft@react_id[model_OTU08_draft@react_num]
# Add reactions to a gs model by for loop
getwd = getwd()
getwd
mydir = '/Users/zzfanyi/Bioinfo/EMP500/02-shotgun/GapSeq_models/STY_models/GapSeq_v20200607_mergebin_gapseq_v0607_MKSdb_Diet_Jo_lALL_b_uncon/2021-01-12_ReactionPool_to_ObjectModel/'
OTU08_draft = paste(mydir,'03_Get_ObjectModel/STY_Merged_OTU08-draft_v20200607.RDS',sep = '')
model_OTU08_draft = readRDS(OTU08_draft)
model_OTU08_draft
React_id = read.delim(paste(mydir,'02_Get_RP_equations/Reaction_id_in_ReactionPool_Addreact.txt',sep = ''))
React_id[1,]
model_OTU08_draft@react_id[model_OTU08_draft@react_num]
React_id[1,]
for (i in nrow(React_id)) {
model_OTU08_draft <- addReact(
model_OTU08_draft,
id         = as.character(React_id[i,]$Rid),
met        = str_split(as.character(React_id[i,]$met_id),',')[[1]],
Scoef      = as.integer(str_split(as.character(React_id[i,]$met_Scoef),',')[[1]]),
reactName  = as.character(React_id[i,]$Rid),
reversible = React_id[i,]$react_rev,
metName    = str_split(as.character(React_id[i,]$met_name),',')[[1]],
metComp    = s.integer(str_split(as.character(React_id[i,]$met_comp),',')[[1]])
)
}
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = as.character(React_id[1,]$Rid),
met        = str_split(as.character(React_id[1,]$met_id),',')[[1]],
Scoef      = as.integer(str_split(as.character(React_id[1,]$met_Scoef),',')[[1]]),
reactName  = as.character(React_id[1,]$Rid),
reversible = React_id[1,]$react_rev,
metName    = str_split(as.character(React_id[1,]$met_name),',')[[1]],
metComp    = as.integer(str_split(as.character(React_id[1,]$met_comp),',')[[1]])
)
# check the latest reaction added:
model_OTU08_draft_new@react_id[model_OTU08_draft_new@react_num]
model_OTU08_draft_new
for (i in nrow(React_id)) {
model_OTU08_draft <- addReact(
model_OTU08_draft,
id         = as.character(React_id[i,]$Rid),
met        = str_split(as.character(React_id[i,]$met_id),',')[[1]],
Scoef      = as.integer(str_split(as.character(React_id[i,]$met_Scoef),',')[[1]]),
reactName  = as.character(React_id[i,]$Rid),
reversible = React_id[i,]$react_rev,
metName    = str_split(as.character(React_id[i,]$met_name),',')[[1]],
metComp    = as.integer(str_split(as.character(React_id[i,]$met_comp),',')[[1]])
)
}
model_OTU08_draft
# check the latest reaction added:
model_OTU08_draft_new@react_id[model_OTU08_draft_new@react_num]
##################### Add reactions to a gs model by for loop #####################
getwd = getwd()
getwd
# Manually create variable 'mydir':
mydir = '/Users/zzfanyi/Bioinfo/EMP500/02-shotgun/GapSeq_models/STY_models/GapSeq_v20200607_mergebin_gapseq_v0607_MKSdb_Diet_Jo_lALL_b_uncon/2021-01-12_ReactionPool_to_ObjectModel/'
# Import the object model (OM):
OTU08_draft = paste(mydir,'03_Get_ObjectModel/STY_Merged_OTU08-draft_v20200607.RDS',sep = '')
model_OTU08_draft = readRDS(OTU08_draft)
model_OTU08_draft
# Import a data frame that include all reactions from reaction pool (RP):
React_id = read.delim(paste(mydir,'02_Get_RP_equations/Reaction_id_in_ReactionPool_Addreact.txt',sep = ''))
##########################  Start with a test #############################
########### add the first RP reaction to the OM from data frame ###########
# Here is the 1st reaction from reaction pool (RP) that we want to add to the object model (OM):
React_id[1,]
# check the last reaction befor adding new reaction(s):
model_OTU08_draft@react_id[model_OTU08_draft@react_num]
# [1] "DM_cpd01042_c0"
as.character(React_id[1,]$Rid)
# [1] "Trans_NH4"
str_split(as.character(React_id[1,]$met_id),',')[[1]]
# [1] "cpd00013[c0]" "cpd00067[e0]" "cpd00013[e0]"
as.integer(str_split(as.character(React_id[1,]$met_Scoef),',')[[1]])
# [1]  1  1 -1
as.character(React_id[1,]$Rid)
# [1] "Trans_NH4"
React_id[1,]$react_rev
# [1] FALSE
str_split(as.character(React_id[1,]$met_name),',')[[1]]
# [1] "NH3"   "H+[e]" "NH4"
as.integer(str_split(as.character(React_id[1,]$met_comp),',')[[1]])
# [1] 1 2 2
# The following commond should equal to:
# model_name <- addReact(
#   model_name,
#   id='Trans_NH4',
#   met=c('cpd00013[c0]','cpd00067[e0]','cpd00013[e0]'),
#   metName = c('NH3','H+[e]','NH4'),
#   Scoef=c(1,1,-1),
#   metComp = c(1,1,1,1)
#   reactName = 'Trans_NH4',
#   reversible= FALSE,
#   lb = 0,
#   up = 1000
# )
model_OTU08_draft_new <- addReact(
model_OTU08_draft,
id         = as.character(React_id[1,]$Rid),
met        = str_split(as.character(React_id[1,]$met_id),',')[[1]],
Scoef      = as.integer(str_split(as.character(React_id[1,]$met_Scoef),',')[[1]]),
reactName  = as.character(React_id[1,]$Rid),
reversible = React_id[1,]$react_rev,
metName    = str_split(as.character(React_id[1,]$met_name),',')[[1]],
metComp    = as.integer(str_split(as.character(React_id[1,]$met_comp),',')[[1]])
)
# check the latest reaction added:
model_OTU08_draft_new@react_id[model_OTU08_draft_new@react_num]
# [1] "Trans_NH4"
##########################  Test ends #############################
##########################  Use For loop to add all RP to OM #############################
for (i in nrow(React_id)) {
model_OTU08_draft <- addReact(
model_OTU08_draft,
id         = as.character(React_id[i,]$Rid),
met        = str_split(as.character(React_id[i,]$met_id),',')[[1]],
Scoef      = as.integer(str_split(as.character(React_id[i,]$met_Scoef),',')[[1]]),
reactName  = as.character(React_id[i,]$Rid),
reversible = React_id[i,]$react_rev,
metName    = str_split(as.character(React_id[i,]$met_name),',')[[1]],
metComp    = as.integer(str_split(as.character(React_id[i,]$met_comp),',')[[1]])
)
}
# check the latest reaction added:
model_OTU08_draft_new@react_id[model_OTU08_draft_new@react_num]
# check the latest reaction added:
model_OTU08_draft@react_id[model_OTU08_draft@react_num]
model_OTU08_draft
